import{u as O,a as h,__tla as P}from"./useViewData.0cfb5ab8.js";import{d as S,aM as j,bd as E,r as _,R as q,ca as A,U as I,o as p,c as l,a3 as M,aT as z,A as B,K,w as L,h as N,N as R,O as T,M as V,dA as C,_ as F,__tla as Q}from"./index.423308b2.js";import{a as U,__tla as G}from"./api.1b485a58.js";import{__tla as H}from"./request.a149cfa0.js";let f,J=Promise.all([(()=>{try{return P}catch{}})(),(()=>{try{return Q}catch{}})(),(()=>{try{return G}catch{}})(),(()=>{try{return H}catch{}})()]).then(async()=>{const y=S({__name:"ViewPreview",setup(W){const D=O(),{viewData:c}=j(D),i=E(),o=_(c.value),u=_(!0),d=()=>{let e=o.value.componentData.map(a=>h(a));Promise.all(e).then(a=>{a.forEach(({id:t,data:s})=>{m(t,s)})})},b=e=>{e&&h(e).then(({id:a,data:t})=>{m(a,t)})},m=(e,a)=>{let t=o.value.componentData.findIndex(s=>s.id==e);if(t!=-1){let s=o.value.componentData[t];const{type:n}=s;switch(n){case"text":o.value.componentData[t].props.value=a;break;case"img":o.value.componentData[t].props.src=a;break;case"iframe":o.value.componentData[t].props.url=a;break;case"chartPie":o.value.componentData[t].props.option.dataset.source=a;break;case"chartBar":o.value.componentData[t].props.option.dataset.source=a;break;case"chartLine":o.value.componentData[t].props.option.dataset.source=a;break;case"icon":o.value.componentData[t].props.icon=a;break;default:o.value.componentData[t].props.value=a;break}}};i.query.id?U.getDetail({id:i.query.id}).then(e=>{const{code:a,data:t,msg:s}=e;u.value=!1,a==0&&(o.value=t,d())}):(o.value=c.value,d());const k=e=>{const{positionSize:{left:a,top:t,width:s,height:n}}=e;return{position:"absolute",left:`${a}px`,top:`${t}px`,width:`${s}px`,height:`${n}px`}},w=()=>({width:`${o.value.width}px`,height:`${o.value.height}px`}),{pool:v}=C(),g={},x=e=>{c.value.componentData.forEach(a=>{a.dataSetting.type=="dev"&&a.dataSetting.params&&Object.keys(a.dataSetting.params).some(t=>e.includes(t))&&b(a)})},$=(e,a)=>{let t=[],s=Object.keys(a),n=Object.keys(e);return s.forEach(r=>{n.includes(r)?e[r]!=a[r]&&t.push(r):t.push(r)}),t};return q(v,()=>{const e=$(g,v);x(e)},{deep:!0}),(e,a)=>{const t=A("loading");return I((p(),l("div",{class:"view-preview",style:w},[(p(!0),l(M,null,z(o.value.componentData,s=>(p(),l("div",{key:s.id,style:B(k(s)),class:"box"},[(p(),K(V(s.name),T(s.props,{preview:!0}),{default:L(()=>[N(R(s.name=="el-text"?s.props.value:""),1)]),_:2},1040))],4))),128))])),[[t,u.value]])}}});f=F(y,[["__scopeId","data-v-c44c3829"]])});export{J as __tla,f as default};
