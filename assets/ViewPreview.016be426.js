import{u as P,__tla as S}from"./viewDesign.11ae6e83.js";import{d as E,bp as j,bN as q,g as h,w as z,aB as B,am as I,o as l,c,a0 as O,al as V,a3 as C,y as L,z as N,aC as Q,au as R,V as F,Z as H,dQ as _,dR as K,_ as M,__tla as T}from"./index.ed9225e0.js";import{a as Z,__tla as A}from"./api.81b2ff23.js";import{__tla as G}from"./request.16a9dfb0.js";let b,J=Promise.all([(()=>{try{return S}catch{}})(),(()=>{try{return T}catch{}})(),(()=>{try{return A}catch{}})(),(()=>{try{return G}catch{}})()]).then(async()=>{const f=E({__name:"ViewPreview",setup(U){const y=P(),{viewData:i}=j(y),u=q(),o=h(i.value),r=h(!0),d=()=>{let e=o.value.componentData.map(a=>_(a));Promise.all(e).then(a=>{a.forEach(({id:t,data:s})=>{v(t,s)})})},D=e=>{e&&_(e).then(({id:a,data:t})=>{v(a,t)})},v=(e,a)=>{let t=o.value.componentData.findIndex(s=>s.id==e);if(t!=-1){let s=o.value.componentData[t];const{type:n}=s;switch(n){case"text":o.value.componentData[t].props.value=a;break;case"img":o.value.componentData[t].props.src=a;break;case"iframe":o.value.componentData[t].props.url=a;break;case"chartPie":o.value.componentData[t].props.option.dataset.source=a;break;case"chartBar":o.value.componentData[t].props.option.dataset.source=a;break;case"chartLine":o.value.componentData[t].props.option.dataset.source=a;break;case"icon":o.value.componentData[t].props.icon=a;break;default:o.value.componentData[t].props.value=a;break}}};u.query.id?Z.getDetail({id:u.query.id}).then(e=>{const{code:a,data:t,msg:s}=e;r.value=!1,a==0&&(o.value=t,d())}):(r.value=!1,o.value=i.value,d());const g=e=>{const{positionSize:{left:a,top:t,width:s,height:n}}=e;return{position:"absolute",left:`${a}px`,top:`${t}px`,width:`${s}px`,height:`${n}px`}},w=()=>({width:`${o.value.width}px`,height:`${o.value.height}px`}),{pool:m}=K(),k={},x=e=>{o.value.componentData.forEach(a=>{a.dataSetting.type=="dev"&&a.dataSetting.params&&e.some(t=>a.dataSetting.params.includes(t))&&D(a)})},$=(e,a)=>{let t=[],s=Object.keys(a),n=Object.keys(e);return s.forEach(p=>{n.includes(p)?e[p]!=a[p]&&t.push(p):t.push(p)}),t};return z(m,()=>{const e=$(k,m);x(e)},{deep:!0}),(e,a)=>{const t=B("ev-loading");return I((l(),c("div",{class:"view-preview",style:w},[(l(!0),c(O,null,V(o.value.componentData,s=>(l(),c("div",{key:s.id,style:C(g(s)),class:"box"},[(l(),L(H(s.name),F(s.props,{preview:!0}),{default:N(()=>[Q(R(s.name=="el-text"?s.props.value:""),1)]),_:2},1040))],4))),128))])),[[t,r.value]])}}});b=M(f,[["__scopeId","data-v-f9abcc0b"]])});export{J as __tla,b as default};
