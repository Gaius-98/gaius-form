import{u as I,a as h,__tla as P}from"./useViewData.a44725a9.js";import{d as S,b0 as j,bq as q,r as _,w as E,ac as O,R as z,o as l,c as r,I as A,Q as B,D as L,z as N,A as R,ad as V,a4 as C,a3 as F,N as G,dI as K,_ as M,__tla as Q}from"./index.88a1aa3e.js";import{a as T,__tla as H}from"./api.33c78e7b.js";let b,J=Promise.all([(()=>{try{return P}catch{}})(),(()=>{try{return Q}catch{}})(),(()=>{try{return H}catch{}})()]).then(async()=>{const D=S({__name:"ViewPreview",setup(U){const f=I(),{viewData:c}=j(f),i=q(),s=_(c.value),u=_(!0),d=()=>{let e=s.value.componentData.map(a=>h(a));Promise.all(e).then(a=>{a.forEach(({id:t,data:o})=>{v(t,o)})})},y=e=>{e&&h(e).then(({id:a,data:t})=>{v(a,t)})},v=(e,a)=>{let t=s.value.componentData.findIndex(o=>o.id==e);if(t!=-1){let o=s.value.componentData[t];const{type:n}=o;switch(n){case"text":s.value.componentData[t].props.value=a;break;case"img":s.value.componentData[t].props.src=a;break;case"iframe":s.value.componentData[t].props.url=a;break;case"chartPie":s.value.componentData[t].props.option.dataset.source=a;break;case"chartBar":s.value.componentData[t].props.option.dataset.source=a;break;case"chartLine":s.value.componentData[t].props.option.dataset.source=a;break;case"icon":s.value.componentData[t].props.icon=a;break;default:s.value.componentData[t].props.value=a;break}}};i.query.id?T.getDetail({id:i.query.id}).then(e=>{const{code:a,data:t,msg:o}=e;u.value=!1,a==0&&(s.value=t,d())}):(s.value=c.value,d());const k=e=>{const{positionSize:{left:a,top:t,width:o,height:n}}=e;return{position:"absolute",left:`${a}px`,top:`${t}px`,width:`${o}px`,height:`${n}px`}},w=()=>({width:`${s.value.width}px`,height:`${s.value.height}px`}),{pool:m}=K(),g={},x=e=>{s.value.componentData.forEach(a=>{a.dataSetting.type=="dev"&&a.dataSetting.params&&Object.keys(a.dataSetting.params).some(t=>e.includes(t))&&y(a)})},$=(e,a)=>{let t=[],o=Object.keys(a),n=Object.keys(e);return o.forEach(p=>{n.includes(p)?e[p]!=a[p]&&t.push(p):t.push(p)}),t};return E(m,()=>{const e=$(g,m);x(e)},{deep:!0}),(e,a)=>{const t=O("loading");return z((l(),r("div",{class:"view-preview",style:w},[(l(!0),r(A,null,B(s.value.componentData,o=>(l(),r("div",{key:o.id,style:L(k(o)),class:"box"},[(l(),N(G(o.name),F(o.props,{preview:!0}),{default:R(()=>[V(C(o.name=="el-text"?o.props.value:""),1)]),_:2},1040))],4))),128))])),[[t,u.value]])}}});b=M(D,[["__scopeId","data-v-f4bb8b10"]])});export{J as __tla,b as default};
