import{cH as ke,cI as xe,cb as Se,r as F,t as x,cJ as H,d as y,cc as T,o as r,c as w,a1 as k,N as O,aG as I,$ as C,b3 as _,aK as A,H as B,ae as E,a6 as S,J,an as ze,u as g,cK as Te,I as K,_ as j,B as N,aI as Oe,b as v,a0 as V,cu as Ie,cv as je,cd as Ve,ce as $e,ci as G,a_ as Me,cL as Pe,cn as Fe,cM as He,cB as Je,__tla as qe}from"./index.bf157839.js";let U,Ae=Promise.all([(()=>{try{return qe}catch{}})()]).then(async()=>{let q,$,M=0,P=0;function W(l,p,i){let o=p&&i||0;const e=p||new Array(16);l=l||{};let d=l.node||q,t=l.clockseq!==void 0?l.clockseq:$;if(d==null||t==null){const c=l.random||(l.rng||ke)();d==null&&(d=q=[c[0]|1,c[1],c[2],c[3],c[4],c[5]]),t==null&&(t=$=(c[6]<<8|c[7])&16383)}let n=l.msecs!==void 0?l.msecs:Date.now(),a=l.nsecs!==void 0?l.nsecs:P+1;const u=n-M+(a-P)/1e4;if(u<0&&l.clockseq===void 0&&(t=t+1&16383),(u<0||n>M)&&l.nsecs===void 0&&(a=0),a>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");M=n,P=a,$=t,n+=122192928e5;const m=((n&268435455)*1e4+a)%4294967296;e[o++]=m>>>24&255,e[o++]=m>>>16&255,e[o++]=m>>>8&255,e[o++]=m&255;const h=n/4294967296*1e4&268435455;e[o++]=h>>>8&255,e[o++]=h&255,e[o++]=h>>>24&15|16,e[o++]=h>>>16&255,e[o++]=t>>>8|128,e[o++]=t&255;for(let c=0;c<6;++c)e[o+c]=d[c];return p||xe(e)}const z=Se("viewStore",()=>{const l=F({componentData:[],name:"",id:"",img:"",height:1080,width:1920}),p=F({name:"",label:"",props:{},id:"",type:"",positionSize:{top:0,left:0,width:100,height:100}}),i=t=>{const{id:n}=t;let a=l.componentData.find(u=>u.id==n);a&&Object.assign(a,{...a,...t})},o=F([]),e=x(0),d=()=>{o[e.value++]=H.exports.cloneDeep(l.componentData)};return{viewData:l,curCompData:p,snapshotData:o,curSnapshotIdx:e,setSnapshot:d,undo:()=>{e.value>0&&(e.value--,l.componentData=H.exports.cloneDeep(o[e.value]))},redo:()=>{e.value<o.length-1&&(e.value++,l.componentData=H.exports.cloneDeep(o[e.value]))},onClickComp:t=>{let n=l.componentData.findIndex(a=>a.id===t.id);n!=-1&&Object.assign(p,l.componentData[n])},setComp:i,addComp:t=>{l.componentData.push(t),d()}}}),L=y({__name:"ViewDesignContainer",setup(l){const p=z(),{viewData:i,curCompData:o}=T(p),{onClickComp:e,setSnapshot:d,setComp:t,addComp:n}=p,a=x(),u=()=>{const{width:f,height:b}=i.value;return a.value?(console.log(a.value.offsetWidth,a.value.offsetHeight,(a.value.offsetHeight-40)/b),{width:f+"px",height:b+"px",transform:`scale(${(a.value.offsetWidth-40)/f},${(a.value.offsetHeight-40)/b})`,"transform-origin":"0 0 "}):{width:"100%",height:"100%"}},m=f=>{const{nodeKey:b,left:s,top:D,width:De,height:Ce}=f;t({id:b,positionSize:{left:parseFloat(s),top:parseFloat(D),width:parseFloat(De),height:parseFloat(Ce)}}),d()},h=f=>{f.preventDefault()},c=f=>{f.preventDefault();let b=JSON.parse(f.dataTransfer.getData("componentData"));b.id=W(),b.positionSize={width:100,height:100,top:f.offsetY,left:f.offsetX},n(b)};return(f,b)=>(r(),w("div",{ref_key:"container",ref:a,class:"view-design-container"},[k("div",{class:"container",style:K(u()),onDragover:h,onDrop:c},[(r(!0),w(O,null,I(g(i).componentData,s=>(r(),C(g(Te),ze({key:s.id,minh:"20",minw:"20","node-key":s.id},s.positionSize,{class:[s.id==g(o).id?"active":"","drag"],onOnDragResize:m,onClick:D=>g(e)(s)}),{default:_(()=>[(r(),C(A(s.name),B(E(s.props)),{default:_(()=>[S(J(s.name=="el-text"?s.props.value:""),1)]),_:2},1040))]),_:2},1040,["node-key","class","onClick"]))),128))],36)],512))}}),R=j(L,[["__scopeId","data-v-bfee6417"]]),X=[{name:"ev-text",id:"1",type:"text",label:"\u6587\u672C\u7EC4\u4EF6",props:{value:"123"}},{name:"ev-img",id:"2",type:"img",label:"\u56FE\u7247\u7EC4\u4EF6",props:{src:"https://img1.baidu.com/it/u=1400131798,3422378849&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1690304400&t=6836d8acb0adcf55038070c7599815d7"}}],Y={class:"material-container"},Q=["data-component"],Z=y({__name:"ViewMaterial",setup(l){const p=i=>{i&&i.target&&i.dataTransfer&&i.dataTransfer.setData("componentData",i.target.getAttribute("data-component"))};return(i,o)=>(r(),w("ul",Y,[(r(!0),w(O,null,I(g(X),e=>(r(),w("li",{key:e.id,class:"material",draggable:"true","data-component":JSON.stringify(e),onDragstart:p},J(e.label),41,Q))),128))]))}}),ee=j(Z,[["__scopeId","data-v-abd2366e"]]),te={class:"view-preview"},ae=y({__name:"ViewPreview",props:{data:{type:Object,required:!0}},setup(l){const p=l,{data:i}=N(p),o=e=>{const{positionSize:{left:d,top:t,width:n,height:a}}=e;return{position:"absolute",left:`${d}px`,top:`${t}px`,width:`${n}px`,height:`${a}px`}};return(e,d)=>(r(),w("div",te,[(r(!0),w(O,null,I(g(i).componentData,t=>(r(),w("div",{key:t.id,style:K(o(t)),class:"box"},[(r(),C(A(t.name),B(E(t.props)),{default:_(()=>[S(J(t.name=="el-text"?t.props.value:""),1)]),_:2},1040))],4))),128))]))}}),le=j(ae,[["__scopeId","data-v-af73bf20"]]),oe=[{label:"\u4F4D\u7F6E\u53CA\u5927\u5C0F\u4FE1\u606F",ui:{type:"collapse",field:"",children:[{label:"\u8DDD\u9876\u90E8\u9AD8\u5EA6",ui:{type:"number",field:"positionSize.top"}},{label:"\u8DDD\u5DE6\u4FA7\u8DDD\u79BB",ui:{type:"number",field:"positionSize.left"}},{label:"\u5BBD\u5EA6",ui:{type:"number",field:"positionSize.width"}},{label:"\u9AD8\u5EA6",ui:{type:"number",field:"positionSize.height"}}]}}],ne=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),se=[{label:"\u7EC4\u4EF6\u5C5E\u6027",ui:{type:"collapse",field:"",children:[{label:"\u56FE\u7247\u5730\u5740",ui:{type:"textarea",field:"props.src"}}]}}],ie=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),ce=[{label:"\u7EC4\u4EF6\u5C5E\u6027",ui:{type:"collapse",field:"",children:[{label:"\u6587\u672C\u5185\u5BB9",ui:{type:"textarea",field:"props.value"}}]}}],pe=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"})),de=y({name:"viewCfg"}),ue=y({...de,props:{template:{default:()=>[]}},setup(l){const p=l,i=z(),{curCompData:o}=T(i),{template:e}=N(p),d=n=>n.split(".").reduce((a,u)=>a[u],o.value),t=(n,a)=>{a.split(".").reduce((u,m,h,c)=>(h==c.length-1&&(console.log(u,n),u[m]=n),u[m]),o.value)};return(n,a)=>{const u=Oe("view-cfg",!0),m=Ie,h=je,c=Ve,f=$e,b=G;return r(!0),w(O,null,I(g(e),s=>(r(),w("div",{key:s.label,class:"view-cfg"},[s.ui.type=="collapse"?(r(),C(h,{key:0},{default:_(()=>[v(m,{title:s.label,name:s.label},{default:_(()=>[v(u,{template:s.ui.children},null,8,["template"])]),_:2},1032,["title","name"])]),_:2},1024)):V("",!0),s.ui.type=="input"?(r(),C(f,{key:1,label:s.label},{default:_(()=>[v(c,{"model-value":d(s.ui.field),onInput:D=>t(D,s.ui.field)},null,8,["model-value","onInput"])]),_:2},1032,["label"])):V("",!0),s.ui.type=="number"?(r(),C(f,{key:2,label:s.label},{default:_(()=>[v(b,{"controls-position":"right","model-value":d(s.ui.field),onChange:D=>t(D,s.ui.field)},null,8,["model-value","onChange"])]),_:2},1032,["label"])):V("",!0),s.ui.type=="textarea"?(r(),C(f,{key:3,label:s.label},{default:_(()=>[v(c,{type:"textarea","model-value":d(s.ui.field),onChange:D=>t(D,s.ui.field)},null,8,["model-value","onChange"])]),_:2},1032,["label"])):V("",!0)]))),128)}}}),re=y({name:"viewTemplate"}),fe=y({...re,setup(l){const p=z(),{curCompData:i}=T(p);Me(i.value,()=>{if(i.value&&i.value.type){let t;for(const n in e.value)n.includes(Pe(i.value.type))&&(t=e.value[n].default,o.value=[...d.value,...t])}},{deep:!0});const o=x([]),e=x(),d=x([]);return(async()=>await Object.assign({"/src/assets/view/viewCfgTemplates/cfgCommonTemplate.ts":ne,"/src/assets/view/viewCfgTemplates/cfgImgTemplate.ts":ie,"/src/assets/view/viewCfgTemplates/cfgTextTemplate.ts":pe}))().then(t=>{e.value=t;for(const n in e.value)if(n.includes("Common")){const a=e.value[n];d.value=a.default}}),(t,n)=>{const a=Fe;return r(),C(a,{"label-width":"80px",size:"small"},{default:_(()=>[v(ue,{template:o.value},null,8,["template"])]),_:1})}}}),me={class:"view-design f-cs"},ve={class:"view-design-header"},he={class:"container f-rs"},ge={class:"material"},be={class:"view-design-main"},_e={class:"material-option"},we=y({name:"viewDesign"}),ye=y({...we,setup(l){const p=z(),{undo:i,redo:o}=p,{viewData:e,curCompData:d}=T(p),t=new He({title:"\u9884\u89C8",size:"large",content:le,cb:a=>{t.destroyed(),console.log(a)},footer:!1,componentProps:{data:e}}),n=()=>{t.create()};return(a,u)=>{const m=Je,h=G;return r(),w("main",me,[k("header",ve,[v(m,{onClick:g(i)},{default:_(()=>[S(" \u64A4\u9500 ")]),_:1},8,["onClick"]),v(m,{onClick:g(o)},{default:_(()=>[S(" \u91CD\u505A ")]),_:1},8,["onClick"]),v(m,{onClick:n},{default:_(()=>[S(" \u9884\u89C8 ")]),_:1}),v(h,{modelValue:g(e).width,"onUpdate:modelValue":u[0]||(u[0]=c=>g(e).width=c)},null,8,["modelValue"]),v(h,{modelValue:g(e).height,"onUpdate:modelValue":u[1]||(u[1]=c=>g(e).height=c)},null,8,["modelValue"])]),k("div",he,[k("aside",ge,[v(ee)]),k("div",be,[v(R)]),k("div",_e,[v(fe)])])])}}});U=j(ye,[["__scopeId","data-v-c6e43d01"]])});export{Ae as __tla,U as default};
